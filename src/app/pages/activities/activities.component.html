<ng-container *transloco="let t; lang: lang; prefix: 'pages.activities'">
  <div>
    @if (authenticationService.isLoggedIn()) {
      <mat-drawer-container hasBackdrop="false">
        <mat-drawer
          #drawer
          mode="over"
          [opened]="!id()"
          (closed)="onDrawerClosed()"
        >
          <mat-list>
            @for (
              activitySummary of activitySummaries();
              track activitySummary
            ) {
              <mat-list-item
                mat-ripple
                class="activity-item"
                (click)="onActivityClicked(activitySummary.id)"
              >
                <mat-icon
                  matListItemIcon
                  class="activity-icon"
                  style="margin-top: 8px"
                  >route</mat-icon
                >
                <div matListItemTitle class="title">
                  {{ activitySummary.title }}
                </div>
                <div matListItemLine class="subtitle">
                  <span>{{ activitySummary.startTime | date: "medium" }}</span>
                  <span class="delimiter">·</span>
                  <span
                    >{{
                      activitySummary.distance | metersToKilometers
                    }}
                    km</span
                  >
                </div>
              </mat-list-item>
            }
          </mat-list>
        </mat-drawer>
        <mat-drawer-content>
          <div class="container flex-container-vertical">
            @if (selectedActivity()) {
              <div class="inner-container">
                <h2>
                  <span mat-card-avatar class="activity-avatar">
                    <span class="material-symbols-outlined activity-icon">
                      route
                    </span>
                  </span>
                  {{ t("terms.activity") }} {{ selectedActivity()?.title }}
                  <span class="delimiter">·</span>
                  <button mat-button (click)="drawer.toggle()">
                    {{ t("actions.show-all") }}
                  </button>
                </h2>

                @for (
                  activityDetail of activityDetails();
                  track activityDetail
                ) {
                  <mat-card mat-ripple>
                    <mat-card-content>
                      <ul class="list">
                        <li>
                          <strong class="label">{{
                            t("terms.distance")
                          }}</strong
                          >:
                          @if (activityDetail?.distance) {
                            {{ activityDetail?.distance }}
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                        <li>
                          <strong class="label">{{
                            t("terms.altitude")
                          }}</strong
                          >:
                          @if (activityDetail?.altitude) {
                            {{ activityDetail?.altitude }} m
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                        <li>
                          <strong class="label">{{ t("terms.speed") }}</strong
                          >:
                          @if (activityDetail?.speed) {
                            {{ activityDetail?.speed }} km/h
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                        <li>
                          <strong class="label">{{ t("terms.cadence") }}</strong
                          >:
                          @if (activityDetail?.cadence) {
                            {{ activityDetail?.cadence }} rpm
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                        <li>
                          <strong class="label">{{
                            t("terms.latitude")
                          }}</strong
                          >:
                          @if (activityDetail?.latitude) {
                            {{ activityDetail?.latitude }}
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                        <li>
                          <strong class="label">{{
                            t("terms.longitude")
                          }}</strong
                          >:
                          @if (activityDetail?.longitude) {
                            {{ activityDetail?.longitude }}
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                        <li>
                          <strong class="label">{{
                            t("terms.riderPower")
                          }}</strong
                          >:
                          @if (activityDetail?.riderPower) {
                            {{ activityDetail?.riderPower }} W
                          } @else {
                            <em>{{ t("terms.undefined") }}</em>
                          }
                        </li>
                      </ul>
                    </mat-card-content>
                  </mat-card>
                }
              </div>
            } @else {
              <div class="inner-container">
                <h2>
                  <span mat-card-avatar class="activity-avatar">
                    <span class="material-symbols-outlined activity-icon">
                      route
                    </span>
                  </span>
                  {{ t("title") }}
                  <span class="delimiter">·</span>
                  <button mat-button (click)="drawer.toggle()">
                    {{ t("actions.show-all") }}
                  </button>
                </h2>
              </div>
            }
            <div class="flex-box"></div>
          </div>
        </mat-drawer-content>
      </mat-drawer-container>
    }
  </div>
</ng-container>
